// ì „ì‹œ ë°ì´í„° ì •ì˜
const exhibitionData = {
    'sensory-dissolution': {
        title: 'DISSOLUTION OF SENSES: ê°ê°í•´ì²´',
        period: '2025.07.01 - 2025.07.31',
        location: 'ì•„íŠ¸ì½”ë¦¬ì•„ë© ë¯¸ë””ì–´ì›”',
        description: 'ë‹¨ì²´ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        fullDescription: 'ë‹¨ì²´ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        photos: [
            'exhibition-details/sensory-dissolution/sensory_dissolution1.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution2.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution3.png',
            'exhibition-details/sensory-dissolution/sensory_dissolution4.png',
            'exhibition-details/sensory-dissolution/sensory_dissolution5.png',
            'exhibition-details/sensory-dissolution/sensory_dissolution6.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution7.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution8.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution9.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution10.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution11.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution12.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution13.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution14.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution15.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution16.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution17.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution18.jpeg'
        ],
        videos: [
            'exhibition-details/sensory-dissolution/sensory_dissolution_video.mp4'
        ]
    },
    'zip': {
        title: '.zip',
        period: '2025.05.26 - 2025.05.29',
        location: 'ê²½ì¼ëŒ€í•™êµ 12í˜¸ê´€ 1F',
        description: 'í•™ê¸°ë§ ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        fullDescription: 'í•™ê¸°ë§ ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        photos: [
            'exhibition-details/zip/zipphoto1.jpg',
            'exhibition-details/zip/zipphoto2.jpeg',
            'exhibition-details/zip/zipphoto3.jpeg',
            'exhibition-details/zip/zipphoto4.jpeg',
            'exhibition-details/zip/zipphoto5.jpeg',
            'exhibition-details/zip/zipphoto6.jpeg',
            'exhibition-details/zip/zipphoto7.jpeg',
            'exhibition-details/zip/zipphoto8.jpeg',
            'exhibition-details/zip/zipphoto9.jpeg',
            'exhibition-details/zip/zipphoto10.jpeg',
            'exhibition-details/zip/zipphoto11.jpeg',
            'exhibition-details/zip/zipphoto12.jpeg',
            'exhibition-details/zip/zipphoto13.jpeg',
            'exhibition-details/zip/zipphoto14.jpeg',
            'exhibition-details/zip/zipphoto15.jpeg',
            'exhibition-details/zip/zipphoto16.jpg',
            'exhibition-details/zip/zipphoto17.JPG',
            'exhibition-details/zip/zipphoto18.jpeg',
            'exhibition-details/zip/zipphoto19.jpeg',
            'exhibition-details/zip/zipphoto20.jpeg',
            'exhibition-details/zip/zipphoto21.jpeg',
            'exhibition-details/zip/zipphoto22.jpeg',
            'exhibition-details/zip/zipphoto23.jpeg'
        ],
        videos: []
    },
    'clear-things': {
        title: 'ì„ ëª…í•´ì ¸ì•¼ í•  ê²ƒë“¤',
        period: '2024.12.20 - 2024.12.31',
        location: 'MOV.A(ì„±ë¯¸ì‚°ë¡œ 888-11 5F)',
        description: 'ê¹€ë‹¤ìŠ¬ êµìˆ˜ë‹˜ ì „ì‹œ ì°¸ì—¬ ë° ì‘í’ˆ ì œì‘',
        fullDescription: 'ê¹€ë‹¤ìŠ¬ êµìˆ˜ë‹˜ ì „ì‹œ ì°¸ì—¬ ë° ì‘í’ˆ ì œì‘',
        photos: [
            'exhibition-details/clear-things/clear-things1.jpg',
            'exhibition-details/clear-things/clear-things2.jpg',
            'exhibition-details/clear-things/clear-things3.jpg',
            'exhibition-details/clear-things/clear-things4.jpg',
            'exhibition-details/clear-things/clear-things5.jpg',
            'exhibition-details/clear-things/clear-things6.jpg',
            'exhibition-details/clear-things/clear-things7.jpg',
            'exhibition-details/clear-things/clear-things8.jpg'
        ],
        videos: []
    },
    'sobok': {
        title: 'ì†Œë³µ',
        period: '2024.12.16 - 2024.12.20',
        location: 'ê²½ì¼ëŒ€í•™êµ 12í˜¸ê´€ 1F',
        description: 'í•™ê¸°ë§ ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        fullDescription: 'í•™ê¸°ë§ ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        photos: [
            'exhibition-details/sobok/sobok_photo1.jpg',
            'exhibition-details/sobok/sobok_photo3.jpg',
            'exhibition-details/sobok/sobok_photo4.jpg',
            'exhibition-details/sobok/sobok_photo5.jpg',
            'exhibition-details/sobok/sobok_photo6.jpg',
            'exhibition-details/sobok/sobok_photo7.jpg',
            'exhibition-details/sobok/sobok_photo8.jpg',
            'exhibition-details/sobok/sobok_photo10_edited.jpg',
            'exhibition-details/sobok/sobok_photo11.jpg',
            'exhibition-details/sobok/sobok_photo12.jpg',
            'exhibition-details/sobok/sobok_photo13.jpg',
            'exhibition-details/sobok/sobok_photo14.jpg',
            'exhibition-details/sobok/sobok_group_photo.jpg',
            'exhibition-details/sobok/sobok_seungje.png',
            'exhibition-details/sobok/sobok_seunghun.png',
            'exhibition-details/sobok/sobok_additional_photo1.jpg',
            'exhibition-details/sobok/sobok_additional_photo2.jpg',
            'exhibition-details/sobok/sobok_additional_photo5.jpg',
            'exhibition-details/sobok/sobok_additional_photo6.jpg',
            'exhibition-details/sobok/sobok_additional_photo7.jpg'
        ],
        videos: []
    },
    'future-fragments': {
        title: 'ë¯¸ë˜ì˜ íŒŒí¸ë“¤',
        period: '2024.10.18 - 2024.11.10',
        location: 'ëŒ€êµ¬ê²½ë¶ë””ìì¸ì„¼í„° 1F Media Wall',
        description: 'êµì™¸ ì „ì‹œ ì‘ê°€ë¡œ ì°¸ì—¬ ë° ì‘í’ˆ ì œì‘',
        fullDescription: 'êµì™¸ ì „ì‹œ ì‘ê°€ë¡œ ì°¸ì—¬ ë° ì‘í’ˆ ì œì‘',
        photos: [
            'exhibition-details/future-fragments/future_fragments_photo1_edited.jpg',
            'exhibition-details/future-fragments/future_fragments_photo2_edited.jpg',
            'exhibition-details/future-fragments/future_fragments_photo3_edited.jpg',
            'exhibition-details/future-fragments/future_fragments_photo5_edited_edited.jpg',
            'exhibition-details/future-fragments/future_fragments_photo6_edited.jpg',
            'exhibition-details/future-fragments/future_fragments_photo7.jpg'
        ],
        videos: []
    },
    'mimyo': {
        title: 'ç¾, ë¬˜í•˜ë‹¤',
        period: '2024.06.04 - 2024.06.10',
        location: 'ê²½ì¼ëŒ€í•™êµ 11í˜¸ê´€ ê°¤ëŸ¬ë¦¬',
        description: 'í•™ê¸°ë§ ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        fullDescription: 'í•™ê¸°ë§ ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        photos: [
            'exhibition-details/mimyo/mimyo_photo1.jpg',
            'exhibition-details/mimyo/mimyo_photo2.jpg',
            'exhibition-details/mimyo/mimyo_photo3.jpg',
            'exhibition-details/mimyo/mimyo_photo4.jpg',
            'exhibition-details/mimyo/mimyo_photo5.jpg',
            'exhibition-details/mimyo/mimyo_photo6.jpg'
        ],
        videos: []
    },
    'meta-festival': {
        title: 'GYEONGBUK META CONTENTS FESTIVAL',
        period: '2024.05.31 - 2024.06.02',
        location: 'ëŒ€êµ¬ EXCO ë™ê´€ 1F HALL 6',
        description: 'ë©”íƒ€ì½˜í…ì¸  í•™ê³¼ ëŒ€í‘œ ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        fullDescription: 'ë©”íƒ€ì½˜í…ì¸  í•™ê³¼ ëŒ€í‘œ ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        photos: [
            'exhibition-details/metacontents-festival/metacontents-composition.png',
            'exhibition-details/metacontents-festival/metacontents-photo1_edited.jpg',
            'exhibition-details/metacontents-festival/metacontents-photo2_edited.jpg',
            'exhibition-details/metacontents-festival/metacontents-photo3_edited.jpg',
            'exhibition-details/metacontents-festival/metacontents-photo4_edited.jpg',
            'exhibition-details/metacontents-festival/metacontents-photo5_edited_edited.jpg',
            'exhibition-details/metacontents-festival/metacontents-process_edited.jpg',
            'exhibition-details/metacontents-festival/metacontents-process2_edited.jpg'
        ],
        videos: []
    },
    'survival': {
        title: 'SURVIVAL',
        period: '2024.02.17 - 2024.02.25',
        location: 'ëŒ€êµ¬ ì¤‘êµ¬ ë™ë•ë¡œ 30ê¸¸ 117 2F ì•„íŠ¸ìŠ¤í…”ë¼ ì†Œë…¸',
        description: 'ë©”íƒ€ì½˜í…ì¸ ìœµí•©ì „ê³µì˜ ì„±ê³¼ ë³´ê³ íšŒ',
        fullDescription: 'ë©”íƒ€ì½˜í…ì¸ ìœµí•©ì „ê³µì˜ ì„±ê³¼ ë³´ê³ íšŒ',
        photos: [
            'exhibition-details/SURVIVAL/survival_photo1.jpg',
            'exhibition-details/SURVIVAL/survival_photo2.jpg',
            'exhibition-details/SURVIVAL/survival_photo3.jpg',
            'exhibition-details/SURVIVAL/survival_photo4.jpg',
            'exhibition-details/SURVIVAL/survival_photo5.jpg',
            'exhibition-details/SURVIVAL/survival_photo6.jpg'
        ],
        videos: [
            'exhibition-details/SURVIVAL/survival_video2.mp4'
        ]
    }
};

// DOMì´ ë¡œë“œëœ í›„ ì‹¤í–‰
document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM ë¡œë“œ ì™„ë£Œ');
    
    // ë¡œë”© í‘œì‹œ
    const loadingElement = document.getElementById('loading');
    if (loadingElement) {
        loadingElement.style.display = 'flex';
    }
    
    // í•„ìˆ˜ DOM ìš”ì†Œ í™•ì¸
    const requiredElements = [
        'exhibitionTitle',
        'exhibitionPeriod', 
        'exhibitionLocation',
        'exhibitionDescription',
        'mediaContainer',
        'loading',
        'backBtn',
        'closeBtn'
    ];
    
    const missingElements = [];
    requiredElements.forEach(id => {
        const element = document.getElementById(id);
        if (!element) {
            missingElements.push(id);
        }
    });
    
    if (missingElements.length > 0) {
        console.error('í•„ìˆ˜ DOM ìš”ì†Œê°€ ì—†ìŠµë‹ˆë‹¤:', missingElements);
        return;
    }
    
    console.log('ëª¨ë“  í•„ìˆ˜ DOM ìš”ì†Œ í™•ì¸ ì™„ë£Œ');
    
    // URL íŒŒë¼ë¯¸í„°ì—ì„œ ì „ì‹œ ID ê°€ì ¸ì˜¤ê¸°
    const urlParams = new URLSearchParams(window.location.search);
    const exhibitionId = urlParams.get('id') || urlParams.get('exhibition');
    
    console.log('URL íŒŒë¼ë¯¸í„°:', { id: urlParams.get('id'), exhibition: urlParams.get('exhibition') });
    console.log('ì„ íƒëœ ì „ì‹œ ID:', exhibitionId);
    
    if (exhibitionId && exhibitionData[exhibitionId]) {
        console.log('ì „ì‹œ ë°ì´í„° ì°¾ìŒ:', exhibitionId);
        loadExhibition(exhibitionId);
    } else {
        // ê¸°ë³¸ê°’ìœ¼ë¡œ ì²« ë²ˆì§¸ ì „ì‹œ ë¡œë“œ
        const firstExhibitionId = Object.keys(exhibitionData)[0];
        console.log('ê¸°ë³¸ ì „ì‹œë¡œ ë¡œë“œ:', firstExhibitionId);
        loadExhibition(firstExhibitionId);
    }
    
    // ë’¤ë¡œê°€ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸
    const backBtn = document.getElementById('backBtn');
    backBtn.addEventListener('click', function() {
        window.history.back();
    });
    
    // ë‹«ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸
    const closeBtn = document.getElementById('closeBtn');
    closeBtn.addEventListener('click', function() {
        window.history.back();
    });
    
    // ESC í‚¤ë¡œ ë’¤ë¡œê°€ê¸°
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            window.history.back();
        }
    });
});

// ì „ì‹œ ë¡œë“œ í•¨ìˆ˜
function loadExhibition(exhibitionId) {
    console.log('ì „ì‹œ ë¡œë“œ ì‹œì‘:', exhibitionId);
    console.log('ì‚¬ìš© ê°€ëŠ¥í•œ ì „ì‹œ:', Object.keys(exhibitionData));
    
    const data = exhibitionData[exhibitionId];
    if (!data) {
        console.error('ì „ì‹œ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', exhibitionId);
        // ë¡œë”© ê°•ì œ í•´ì œ
        const loadingElement = document.getElementById('loading');
        if (loadingElement) {
            loadingElement.style.display = 'none';
        }
        return;
    }
    
    console.log('ì „ì‹œ ë°ì´í„°:', data);
    
    // í—¤ë” ì •ë³´ ì„¤ì •
    document.getElementById('exhibitionTitle').textContent = data.title;
    document.getElementById('exhibitionPeriod').textContent = data.period;
    document.getElementById('exhibitionLocation').textContent = data.location;
    
    // ì „ì‹œ ìƒì„¸ ì„¤ëª… ì„¤ì •
    const descriptionElement = document.getElementById('exhibitionDescription');
    if (data.fullDescription) {
        descriptionElement.textContent = data.fullDescription;
        descriptionElement.style.display = 'block';
    } else {
        descriptionElement.style.display = 'none';
    }
    
    // ìƒˆë¡œìš´ ëª¨ë˜ ê°¤ëŸ¬ë¦¬ ìƒì„±
    createModernExhibitionGallery(data);
}

// ìƒˆë¡œìš´ ëª¨ë˜ ê°¤ëŸ¬ë¦¬ ìƒì„± í•¨ìˆ˜
function createModernExhibitionGallery(data) {
    console.log('ìƒˆë¡œìš´ ëª¨ë˜ ê°¤ëŸ¬ë¦¬ ìƒì„± ì‹œì‘:', data.title);
    
    // ë¯¸ë””ì–´ ì»¨í…Œì´ë„ˆ ì°¾ê¸°
    const mediaContainer = document.getElementById('mediaContainer');
    if (!mediaContainer) {
        console.error('ë¯¸ë””ì–´ ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
        return;
    }
    
    // ëª¨ë“  ë¯¸ë””ì–´ íŒŒì¼ì„ í•˜ë‚˜ì˜ ë°°ì—´ë¡œ í•©ì¹˜ê¸°
    const allMedia = [];
    
    // ì‚¬ì§„ ì¶”ê°€
    if (data.photos && data.photos.length > 0) {
        data.photos.forEach(photo => {
            allMedia.push({
                type: 'photo',
                src: photo,
                title: data.title
            });
        });
    }
    
    // ì˜ìƒ ì¶”ê°€
    if (data.videos && data.videos.length > 0) {
        data.videos.forEach(video => {
            allMedia.push({
                type: 'video',
                src: video,
                title: data.title
            });
        });
    }
    
    console.log('ë¯¸ë””ì–´ ë°°ì—´ ìƒì„± ì™„ë£Œ:', allMedia.length, 'ê°œ ì•„ì´í…œ');
    
    if (allMedia.length === 0) {
        mediaContainer.innerHTML = `
            <div class="modern-gallery">
                <div class="gallery-header">
                    <h2 class="gallery-title">ë¯¸ë””ì–´ ì—†ìŒ</h2>
                    <p class="gallery-subtitle">í‘œì‹œí•  ë¯¸ë””ì–´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                </div>
            </div>
        `;
        return;
    }
    
    // ìƒˆë¡œìš´ ëª¨ë˜ ê°¤ëŸ¬ë¦¬ HTML êµ¬ì¡° ìƒì„± (í—¤ë” ì œê±°)
    mediaContainer.innerHTML = `
        <div class="modern-gallery">
            <div class="masonry-grid" id="masonry-container">
                <!-- ë¯¸ë””ì–´ ì•„ì´í…œë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
            </div>
        </div>
    `;
    
    // ë¯¸ë””ì–´ ì•„ì´í…œë“¤ ìƒì„±
    createModernGalleryItems(allMedia);
    
    // ë¡œë”© ìˆ¨ê¸°ê¸°
    const loadingElement = document.getElementById('loading');
    if (loadingElement) {
        loadingElement.style.display = 'none';
    }
    
    console.log('ìƒˆë¡œìš´ ëª¨ë˜ ê°¤ëŸ¬ë¦¬ ìƒì„± ì™„ë£Œ');
}

// ëª¨ë˜ ê°¤ëŸ¬ë¦¬ ì•„ì´í…œë“¤ ìƒì„± í•¨ìˆ˜
function createModernGalleryItems(mediaArray) {
    const container = document.getElementById('masonry-container');
    if (!container) {
        console.error('ë§ˆì‚¬ì§€ ì»¨í…Œì´ë„ˆë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
        return;
    }
    
    console.log('ê°¤ëŸ¬ë¦¬ ì•„ì´í…œ ìƒì„± ì‹œì‘:', mediaArray.length, 'ê°œ');
    
    mediaArray.forEach((media, index) => {
        const item = document.createElement('div');
        item.className = 'gallery-item';
        
        if (media.type === 'photo') {
            // ì´ë¯¸ì§€ ì•„ì´í…œ ìƒì„±
            const img = document.createElement('img');
            img.src = media.src;
            img.alt = media.title;
            img.loading = 'lazy';
            
            img.onload = function() {
                console.log('ì´ë¯¸ì§€ ë¡œë“œ ì„±ê³µ:', media.src);
            };
            
            img.onerror = function() {
                console.error('ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨:', media.src);
                item.innerHTML = `
                    <div class="loading-placeholder">
                        <div>
                            <div style="font-size: 48px; margin-bottom: 10px;">ğŸ“·</div>
                            <div>ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>
                        </div>
                    </div>
                `;
            };
            
            // í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
            item.addEventListener('click', function() {
                openModernLightbox(media.src, media.title, 'image');
            });
            
            item.appendChild(img);
            
        } else if (media.type === 'video') {
            // ë¹„ë””ì˜¤ ì•„ì´í…œ ìƒì„±
            const video = document.createElement('video');
            video.src = media.src;
            video.muted = true;
            video.playsInline = true;
            video.preload = 'metadata'; // ì˜ìƒ ë©”íƒ€ë°ì´í„°ì™€ ì²« í”„ë ˆì„ ë¡œë“œ
            
            // 1ì´ˆ ì§€ì ì˜ í”„ë ˆì„ì„ ì¸ë„¤ì¼ë¡œ ì‚¬ìš©
            video.currentTime = 1;
            
            // ë¹„ë””ì˜¤ ì˜¤ë²„ë ˆì´ ì¶”ê°€
            const overlay = document.createElement('div');
            overlay.className = 'video-overlay';
            overlay.innerHTML = 'â–¶';
            
            video.onloadedmetadata = function() {
                console.log('ë¹„ë””ì˜¤ ë¡œë“œ ì„±ê³µ:', media.src);
                // ë©”íƒ€ë°ì´í„° ë¡œë“œ í›„ 1ì´ˆ ì§€ì ìœ¼ë¡œ ì´ë™
                video.currentTime = 1;
            };
            
            // ì²« ë²ˆì§¸ í”„ë ˆì„ì„ ë¹ ë¥´ê²Œ ë¡œë“œí•˜ê¸° ìœ„í•œ ì„¤ì •
            video.onloadeddata = function() {
                console.log('ë¹„ë””ì˜¤ ì²« í”„ë ˆì„ ë¡œë“œ ì™„ë£Œ:', media.src);
            };
            
            video.onerror = function() {
                console.error('ë¹„ë””ì˜¤ ë¡œë“œ ì‹¤íŒ¨:', media.src);
                item.innerHTML = `
                    <div class="loading-placeholder">
                        <div>
                            <div style="font-size: 48px; margin-bottom: 10px;">ğŸ¥</div>
                            <div>ë¹„ë””ì˜¤ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>
                        </div>
                    </div>
                `;
            };
            
            // í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
            item.addEventListener('click', function() {
                openModernLightbox(media.src, media.title, 'video');
            });
            
            item.appendChild(video);
            item.appendChild(overlay);
        }
        
        container.appendChild(item);
        console.log(`ê°¤ëŸ¬ë¦¬ ì•„ì´í…œ ${index + 1} ìƒì„± ì™„ë£Œ:`, media.type);
    });
    
    console.log('ëª¨ë“  ê°¤ëŸ¬ë¦¬ ì•„ì´í…œ ìƒì„± ì™„ë£Œ');
}

// ìƒˆë¡œìš´ ëª¨ë˜ ë¼ì´íŠ¸ë°•ìŠ¤ í•¨ìˆ˜
function openModernLightbox(src, title, type) {
    console.log('ë¼ì´íŠ¸ë°•ìŠ¤ ì—´ê¸°:', src, type);
    
    // ê¸°ì¡´ ë¼ì´íŠ¸ë°•ìŠ¤ ì œê±°
    const existingLightbox = document.querySelector('.modern-lightbox');
    if (existingLightbox) {
        existingLightbox.remove();
    }
    
    // ìƒˆë¡œìš´ ë¼ì´íŠ¸ë°•ìŠ¤ ìƒì„±
    const lightbox = document.createElement('div');
    lightbox.className = 'modern-lightbox';
    
    const content = document.createElement('div');
    content.className = 'lightbox-content';
    
    if (type === 'image') {
        const img = document.createElement('img');
        img.src = src;
        img.alt = title;
        
        img.onload = function() {
            console.log('ë¼ì´íŠ¸ë°•ìŠ¤ ì´ë¯¸ì§€ ë¡œë“œ ì„±ê³µ');
        };
        
        img.onerror = function() {
            console.error('ë¼ì´íŠ¸ë°•ìŠ¤ ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨');
            content.innerHTML = `
                <div style="color: white; text-align: center; padding: 50px;">
                    <div style="font-size: 48px; margin-bottom: 20px;">ğŸ“·</div>
                    <div>ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>
                </div>
            `;
        };
        
        content.appendChild(img);
        
    } else if (type === 'video') {
        const video = document.createElement('video');
        video.src = src;
        video.controls = true;
        video.autoplay = true;
        video.muted = false;
        
        video.onloadedmetadata = function() {
            console.log('ë¼ì´íŠ¸ë°•ìŠ¤ ë¹„ë””ì˜¤ ë¡œë“œ ì„±ê³µ');
        };
        
        video.onerror = function() {
            console.error('ë¼ì´íŠ¸ë°•ìŠ¤ ë¹„ë””ì˜¤ ë¡œë“œ ì‹¤íŒ¨');
            content.innerHTML = `
                <div style="color: white; text-align: center; padding: 50px;">
                    <div style="font-size: 48px; margin-bottom: 20px;">ğŸ¥</div>
                    <div>ë¹„ë””ì˜¤ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>
                </div>
            `;
        };
        
        content.appendChild(video);
    }
    
    // ë‹«ê¸° ë²„íŠ¼ ì¶”ê°€
    const closeBtn = document.createElement('button');
    closeBtn.className = 'lightbox-close';
    closeBtn.innerHTML = 'Ã—';
    closeBtn.addEventListener('click', closeLightbox);
    
    content.appendChild(closeBtn);
    lightbox.appendChild(content);
    document.body.appendChild(lightbox);
    
    // ë¼ì´íŠ¸ë°•ìŠ¤ í‘œì‹œ ì• ë‹ˆë©”ì´ì…˜
    setTimeout(() => {
        lightbox.classList.add('active');
    }, 10);
    
    // ë°°ê²½ í´ë¦­ì‹œ ë‹«ê¸°
    lightbox.addEventListener('click', function(e) {
        if (e.target === lightbox) {
            closeLightbox();
        }
    });
    
    // ESC í‚¤ë¡œ ë‹«ê¸°
    const handleEscape = function(e) {
        if (e.key === 'Escape') {
            closeLightbox();
        }
    };
    document.addEventListener('keydown', handleEscape);
    
    function closeLightbox() {
        lightbox.classList.remove('active');
        setTimeout(() => {
            if (document.body.contains(lightbox)) {
                document.body.removeChild(lightbox);
            }
        }, 400);
        document.removeEventListener('keydown', handleEscape);
    }
}

// ë°°ì—´ì„ ëœë¤í•˜ê²Œ ì„ëŠ” í•¨ìˆ˜ (ì‚¬ìš©í•˜ì§€ ì•Šì§€ë§Œ í˜¸í™˜ì„±ì„ ìœ„í•´ ìœ ì§€)
function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

// ì „ì—­ ë³€ìˆ˜ë¡œ í˜„ì¬ ìŠ¬ë¼ì´ë“œ ìƒíƒœ ê´€ë¦¬
let currentSlideIndex = 0;
let totalSlidesCount = 0;
let sliderContainerGlobal = null;

// ìŠ¬ë¼ì´ë” í˜•ì‹ìœ¼ë¡œ ë¯¸ë””ì–´ ì•„ì´í…œ ìƒì„±
function createMediaItems(mediaArray, container) {
    console.log('createMediaItems ì‹œì‘:', { mediaArrayLength: mediaArray.length, container: container });
    
    if (!container) {
        console.error('ì»¨í…Œì´ë„ˆê°€ ì—†ìŠµë‹ˆë‹¤');
        return;
    }
    
    // ì „ì—­ ë³€ìˆ˜ ì´ˆê¸°í™”
    currentSlideIndex = 0;
    totalSlidesCount = mediaArray.length;
    
    // ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ ì„¤ì •
    container.style.height = 'calc(100vh - 200px)';
    container.style.minHeight = '500px';
    container.style.position = 'relative';
    container.style.overflow = 'hidden';
    container.style.backgroundColor = '#ffffff';
    
    console.log('ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ ì„¤ì • ì™„ë£Œ');
    
    // ìŠ¬ë¼ì´ë” ì»¨í…Œì´ë„ˆ ìƒì„±
    const sliderContainer = document.createElement('div');
    sliderContainer.className = 'slider-container';
    sliderContainerGlobal = sliderContainer;
    
    sliderContainer.style.cssText = `
        display: flex;
        transition: transform 0.3s ease;
        height: 100%;
        width: ${mediaArray.length * 100}%;
        position: relative;
    `;
    
    console.log('ìŠ¬ë¼ì´ë” ì»¨í…Œì´ë„ˆ ìƒì„±:', { width: `${mediaArray.length * 100}%`, totalSlides: mediaArray.length });
    
    // ê° ìŠ¬ë¼ì´ë“œ ìƒì„±
    mediaArray.forEach((media, index) => {
        const slide = document.createElement('div');
        slide.className = 'slide-item';
        slide.style.cssText = `
            flex: 0 0 100%;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            box-sizing: border-box;
            position: relative;
            background: transparent;
            overflow: visible;
        `;
        
        // ë¯¸ë””ì–´ ì•„ì´í…œ ìƒì„±
        if (media.type === 'photo') {
            console.log('ì´ë¯¸ì§€ ìƒì„± ì¤‘:', media.src);
            
            // ë¡œë”© í”Œë ˆì´ìŠ¤í™€ë” ë¨¼ì € ìƒì„±
            const loadingDiv = document.createElement('div');
            loadingDiv.style.cssText = `
                width: 100%;
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
                background: #f8f8f8;
                color: #666;
                font-size: 14px;
            `;
            loadingDiv.innerHTML = `
                <div>
                    <div style="font-size: 24px; margin-bottom: 10px;">â³</div>
                    <div>ì´ë¯¸ì§€ ë¡œë”© ì¤‘...</div>
                </div>
            `;
            slide.appendChild(loadingDiv);
            
            // ì´ë¯¸ì§€ ìƒì„± ë° ë¡œë“œ
            const img = document.createElement('img');
            img.style.cssText = `
                max-width: 90%;
                max-height: 80%;
                width: auto;
                height: auto;
                object-fit: contain;
                border-radius: 8px;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
                cursor: pointer;
                transition: transform 0.3s ease;
                display: block;
                visibility: visible;
                opacity: 1;
            `;
            
            img.onload = function() {
                console.log('ì´ë¯¸ì§€ ë¡œë“œ ì„±ê³µ:', media.src);
                console.log('ì‹¤ì œ ë¡œë“œëœ URL:', this.src);
                console.log('ì´ë¯¸ì§€ í¬ê¸°:', this.naturalWidth, 'x', this.naturalHeight);
                
                // ë¡œë”© í”Œë ˆì´ìŠ¤í™€ë” ì œê±°í•˜ê³  ì´ë¯¸ì§€ ì¶”ê°€
                slide.removeChild(loadingDiv);
                slide.appendChild(img);
            };
            
            img.onerror = function() {
                console.error('ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨:', media.src);
                console.error('ì‹¤ì œ ì‹œë„ëœ URL:', this.src);
                
                // ë¡œë”© í”Œë ˆì´ìŠ¤í™€ë”ë¥¼ ì—ëŸ¬ ë©”ì‹œì§€ë¡œ êµì²´
                loadingDiv.innerHTML = `
                    <div>
                        <div style="font-size: 48px; margin-bottom: 10px;">ğŸ“·</div>
                        <div>ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>
                        <div style="font-size: 12px; margin-top: 10px;">${media.src.split('/').pop()}</div>
                    </div>
                `;
            };
            
            img.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                console.log('ì´ë¯¸ì§€ í´ë¦­ë¨:', media.src);
                openImageModal(encodeURI(media.src), media.title);
            });
            
            // ì´ë¯¸ì§€ ë¡œë“œ ì‹œì‘
            img.src = media.src;
            img.alt = media.title;
            
        } else if (media.type === 'video') {
            const videoContainer = document.createElement('div');
            videoContainer.style.cssText = `
                position: relative;
                max-width: 90%;
                max-height: 80%;
                border-radius: 8px;
                overflow: hidden;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
                cursor: pointer;
            `;
            
            const video = document.createElement('video');
            video.src = media.src;
            video.muted = true;
            video.loop = true;
            video.playsInline = true;
            video.preload = 'metadata';
            video.controls = false;
            
            // í¬ìŠ¤í„° ì´ë¯¸ì§€ ì„¤ì • (ì¸ë„¤ì¼ìš©)
            if (media.src.includes('sensory-dissolution')) {
                video.poster = 'exhibition-details/sensory-dissolution/sensory_dissolution1.jpeg';
            } else if (media.src.includes('SURVIVAL')) {
                video.poster = 'exhibition-details/SURVIVAL/survival_photo1.jpg';
            }
            video.style.cssText = `
                max-width: 100%;
                max-height: 100%;
                width: auto;
                height: auto;
                display: block;
                object-fit: contain;
            `;
            
            video.onerror = function() {
                console.log('ë¹„ë””ì˜¤ ë¡œë“œ ì‹¤íŒ¨:', media.src);
                videoContainer.innerHTML = `
                    <div style="
                        width: 100%;
                        height: 200px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        background: #f5f5f5;
                        color: #666;
                        font-size: 14px;
                        text-align: center;
                    ">
                        <div>
                            <div style="font-size: 48px; margin-bottom: 10px;">ğŸ¥</div>
                            <div>ë¹„ë””ì˜¤ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>
                        </div>
                    </div>
                `;
            };
            
            video.onloadedmetadata = function() {
                console.log('ë¹„ë””ì˜¤ ë¡œë“œ ì„±ê³µ:', media.src);
                // ë©”íƒ€ë°ì´í„° ë¡œë“œ í›„ 1ì´ˆ ì§€ì ìœ¼ë¡œ ì´ë™
                video.currentTime = 1;
            };
            
            // ì¬ìƒ ë²„íŠ¼ ì˜¤ë²„ë ˆì´
            const playButton = document.createElement('div');
            playButton.style.cssText = `
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(0, 0, 0, 0.8);
                color: white;
                width: 80px;
                height: 80px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 2rem;
                cursor: pointer;
                transition: all 0.3s ease;
                z-index: 2;
            `;
            playButton.textContent = 'â–¶';
            
            videoContainer.appendChild(video);
            videoContainer.appendChild(playButton);
            
            videoContainer.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                console.log('ë¹„ë””ì˜¤ í´ë¦­ë¨:', media.src);
                openVideoModal(media.src, media.title);
            });
            
            slide.appendChild(videoContainer);
        }
        
        sliderContainer.appendChild(slide);
        console.log(`ìŠ¬ë¼ì´ë“œ ${index + 1} ìƒì„± ì™„ë£Œ:`, { mediaType: media.type, mediaSrc: media.src });
    });
    
    container.appendChild(sliderContainer);
    console.log('ìŠ¬ë¼ì´ë” ì»¨í…Œì´ë„ˆ ì¶”ê°€ ì™„ë£Œ');
    
    // í•˜ë‹¨ ë¯¸ë¦¬ë³´ê¸° ì¸ë„¤ì¼ ì¶”ê°€
    addBottomThumbnailPreview(container, mediaArray);
    console.log('í•˜ë‹¨ ì¸ë„¤ì¼ ë¯¸ë¦¬ë³´ê¸° ì¶”ê°€ ì™„ë£Œ');
    
    // ë„¤ë¹„ê²Œì´ì…˜ ì»¨íŠ¸ë¡¤ ì¶”ê°€
    addSliderControls(container, mediaArray.length);
    console.log('ìŠ¬ë¼ì´ë” ì»¨íŠ¸ë¡¤ ì¶”ê°€ ì™„ë£Œ');
    
    // í„°ì¹˜/ë§ˆìš°ìŠ¤/ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ ì¶”ê°€
    addSliderEvents(sliderContainer, mediaArray.length);
    console.log('ìŠ¬ë¼ì´ë” ì´ë²¤íŠ¸ ì¶”ê°€ ì™„ë£Œ');
    
    // ë¡œë”© ìˆ¨ê¸°ê¸°
    const loadingElement = document.getElementById('loading');
    if (loadingElement) {
        loadingElement.style.display = 'none';
    }
}

// ìŠ¬ë¼ì´ë“œ ì•„ì´í…œ ìƒì„± í•¨ìˆ˜ëŠ” ì œê±°ë¨ - createMediaItems í•¨ìˆ˜ ë‚´ì—ì„œ ì§ì ‘ ì²˜ë¦¬

// ì „ì—­ ìŠ¬ë¼ì´ë” ìœ„ì¹˜ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
function updateSliderPosition(newIndex) {
    if (sliderContainerGlobal && newIndex >= 0 && newIndex < totalSlidesCount) {
        currentSlideIndex = newIndex;
        
        // ìœ„ì¹˜ ê³„ì‚° - ê° ìŠ¬ë¼ì´ë“œê°€ ì „ì²´ ë„ˆë¹„ë¥¼ ì°¨ì§€í•˜ë¯€ë¡œ 100%ì”© ì´ë™
        const translateX = -(currentSlideIndex * 100);
        
        sliderContainerGlobal.style.transform = `translateX(${translateX}%)`;
        
        console.log('ìŠ¬ë¼ì´ë” ìœ„ì¹˜ ì—…ë°ì´íŠ¸:', { 
            index: currentSlideIndex, 
            translateX, 
            totalSlides: totalSlidesCount,
            containerWidth: sliderContainerGlobal.offsetWidth
        });
        
        // ì¸ë””ì¼€ì´í„° ì—…ë°ì´íŠ¸
        const indicator = document.querySelector('.slider-indicator');
        if (indicator) {
            indicator.textContent = `${currentSlideIndex + 1} / ${totalSlidesCount}`;
        }
        
        // ì¸ë„¤ì¼ í•˜ì´ë¼ì´íŠ¸ ì—…ë°ì´íŠ¸
        document.querySelectorAll('.bottom-thumbnail-item').forEach((item, i) => {
            item.style.borderColor = i === currentSlideIndex ? '#28eb25' : 'transparent';
        });
        
        // ì„ íƒëœ ì¸ë„¤ì¼ì„ í™”ë©´ ì¤‘ì•™ìœ¼ë¡œ ìŠ¤í¬ë¡¤
        const selectedThumbnail = document.querySelectorAll('.bottom-thumbnail-item')[currentSlideIndex];
        if (selectedThumbnail) {
            const thumbnailContainer = selectedThumbnail.closest('.bottom-thumbnail-preview');
            if (thumbnailContainer) {
                const containerWidth = thumbnailContainer.offsetWidth;
                const thumbnailWidth = selectedThumbnail.offsetWidth;
                const thumbnailLeft = selectedThumbnail.offsetLeft;
                const scrollLeft = thumbnailLeft - (containerWidth / 2) + (thumbnailWidth / 2);
                
                thumbnailContainer.scrollTo({
                    left: scrollLeft,
                    behavior: 'smooth'
                });
            }
        }
        
        // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
        const prevBtn = document.querySelector('.prev-btn');
        const nextBtn = document.querySelector('.next-btn');
        if (prevBtn && nextBtn) {
            prevBtn.disabled = currentSlideIndex === 0;
            nextBtn.disabled = currentSlideIndex === totalSlidesCount - 1;
            prevBtn.style.opacity = currentSlideIndex === 0 ? '0.5' : '1';
            nextBtn.style.opacity = currentSlideIndex === totalSlidesCount - 1 ? '0.5' : '1';
        }
    }
}

// í•˜ë‹¨ ì¸ë„¤ì¼ ë¯¸ë¦¬ë³´ê¸° ì¶”ê°€ (ì•„ì´í° ì‚¬ì§„ ì•± ìŠ¤íƒ€ì¼)
function addBottomThumbnailPreview(container, mediaArray) {
    const thumbnailContainer = document.createElement('div');
    thumbnailContainer.className = 'bottom-thumbnail-preview';
    thumbnailContainer.style.cssText = `
        position: absolute;
        bottom: 80px;
        left: 50%;
        transform: translateX(-50%);
        width: 90%;
        max-width: 600px;
        height: 80px;
        background: rgba(0, 0, 0, 0.7);
        border-radius: 20px;
        padding: 10px;
        backdrop-filter: blur(10px);
        z-index: 100;
        display: flex;
        gap: 8px;
        overflow-x: auto;
        overflow-y: hidden;
        scrollbar-width: none;
        -ms-overflow-style: none;
        scroll-behavior: smooth;
    `;
    
    // ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¸°ê¸°
    thumbnailContainer.style.webkitScrollbar = 'none';
    
    // ê° ë¯¸ë””ì–´ì˜ ì¸ë„¤ì¼ ìƒì„±
    mediaArray.forEach((media, index) => {
        const thumbnail = document.createElement('div');
        thumbnail.className = 'bottom-thumbnail-item';
        thumbnail.style.cssText = `
            flex: 0 0 60px;
            height: 60px;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            position: relative;
            background: #333;
        `;
        
        if (media.type === 'photo') {
            const img = document.createElement('img');
            img.src = media.src;
            img.style.cssText = `
                width: 100%;
                height: 100%;
                object-fit: cover;
            `;
            img.onerror = function() {
                thumbnail.innerHTML = `
                    <div style="
                        width: 100%;
                        height: 100%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        background: #444;
                        color: #999;
                        font-size: 12px;
                    ">ğŸ“·</div>
                `;
            };
            thumbnail.appendChild(img);
        } else if (media.type === 'video') {
            const video = document.createElement('video');
            video.src = media.src;
            video.muted = true;
            video.playsInline = true;
            video.preload = 'metadata'; // ì˜ìƒ ë©”íƒ€ë°ì´í„°ì™€ ì²« í”„ë ˆì„ ë¡œë“œ
            
            // 1ì´ˆ ì§€ì ì˜ í”„ë ˆì„ì„ ì¸ë„¤ì¼ë¡œ ì‚¬ìš©
            video.currentTime = 1;
            video.style.cssText = `
                width: 100%;
                height: 100%;
                object-fit: cover;
            `;
            
            // ë¹„ë””ì˜¤ ì¸ë„¤ì¼ ì˜¤ë²„ë ˆì´
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.4);
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                font-size: 14px;
            `;
            overlay.textContent = 'â–¶';
            
            thumbnail.appendChild(video);
            thumbnail.appendChild(overlay);
        }
        
        // ì¸ë„¤ì¼ í´ë¦­ ì´ë²¤íŠ¸
        thumbnail.addEventListener('click', function() {
            // ì „ì—­ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¬ë¼ì´ë” ìœ„ì¹˜ ì—…ë°ì´íŠ¸
            updateSliderPosition(index);
        });
        
        // ì²« ë²ˆì§¸ ì¸ë„¤ì¼ í•˜ì´ë¼ì´íŠ¸
        if (index === 0) {
            thumbnail.style.borderColor = '#28eb25';
        }
        
        thumbnailContainer.appendChild(thumbnail);
    });
    
    container.appendChild(thumbnailContainer);
}

// ë¯¸ë””ì–´ ì•„ì´í…œ ìƒì„± (ê¸°ì¡´ í•¨ìˆ˜ëŠ” ìœ ì§€í•˜ë˜ ìŠ¬ë¼ì´ë”ìš©ìœ¼ë¡œ ë³„ë„ ì²˜ë¦¬)
function createMediaItem(media, index) {
    const item = document.createElement('div');
    item.className = `media-item ${media.type}-item`;
    
    if (media.type === 'photo') {
        const img = document.createElement('img');
        img.src = media.src;
        img.alt = media.title;
        img.loading = 'lazy';
        
        img.onerror = function() {
            console.log('ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨:', media.src);
            item.innerHTML = `
                <div style="
                    width: 100%;
                    height: 100%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    background: #f5f5f5;
                    color: #666;
                    font-size: 12px;
                    text-align: center;
                    padding: 10px;
                    border: 1px solid #ddd;
                ">
                    <div>
                        <div style="font-size: 24px; margin-bottom: 5px;">ğŸ“·</div>
                        <div>ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>
                        <div style="font-size: 10px; margin-top: 5px;">${media.src.split('/').pop()}</div>
                    </div>
                </div>
            `;
        };
        
        img.onload = function() {
            console.log('ì´ë¯¸ì§€ ë¡œë“œ ì„±ê³µ:', media.src);
        };
        
        item.appendChild(img);
        
        item.addEventListener('click', function() {
            openImageModal(encodeURI(media.src), media.title);
        });
        
    } else if (media.type === 'video') {
        const video = document.createElement('video');
        video.src = media.src;
        video.muted = true;
        video.loop = true;
        video.playsInline = true;
        video.preload = 'metadata'; // ì˜ìƒ ë©”íƒ€ë°ì´í„°ì™€ ì²« í”„ë ˆì„ ë¡œë“œ
        
        video.onerror = function() {
            console.log('ë¹„ë””ì˜¤ ë¡œë“œ ì‹¤íŒ¨:', media.src);
            item.style.display = 'none';
        };
        
        video.onloadedmetadata = function() {
            console.log('ë¹„ë””ì˜¤ ë¡œë“œ ì„±ê³µ:', media.src);
            // ë©”íƒ€ë°ì´í„° ë¡œë“œ í›„ 1ì´ˆ ì§€ì ìœ¼ë¡œ ì´ë™
            video.currentTime = 1;
        };
        
        item.appendChild(video);
        
        item.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            openVideoModal(media.src, media.title);
        });
        
        item.addEventListener('mouseenter', function() {
            video.play().then(() => {
                item.style.setProperty('--play-icon-opacity', '0');
            }).catch(error => {
                console.log('ë¹„ë””ì˜¤ ìë™ ì¬ìƒ ì‹¤íŒ¨:', error);
            });
        });
        
        item.addEventListener('mouseleave', function() {
            video.pause();
            item.style.setProperty('--play-icon-opacity', '1');
        });
        
        item.addEventListener('touchstart', function(e) {
            e.preventDefault();
            openVideoModal(encodeURI(media.src), media.title);
        });
    }
    
    return item;
}

// ìŠ¬ë¼ì´ë” ì»¨íŠ¸ë¡¤ ì¶”ê°€
function addSliderControls(container, totalSlides) {
    console.log('addSliderControls ì‹œì‘:', { totalSlides, container });
    
    if (!container) {
        console.error('ì»¨í…Œì´ë„ˆê°€ ì—†ìŠµë‹ˆë‹¤');
        return;
    }
    
    // ë„¤ë¹„ê²Œì´ì…˜ ì»¨í…Œì´ë„ˆ
    const navContainer = document.createElement('div');
    navContainer.className = 'slider-nav';
    navContainer.style.cssText = `
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 10px;
        z-index: 100;
        background: rgba(0, 0, 0, 0.5);
        padding: 10px 15px;
        border-radius: 25px;
        backdrop-filter: blur(10px);
    `;
    
    // ì´ì „/ë‹¤ìŒ ë²„íŠ¼
    const prevBtn = document.createElement('button');
    prevBtn.innerHTML = 'â€¹';
    prevBtn.className = 'slider-btn prev-btn';
    prevBtn.style.cssText = `
        background: rgba(40, 235, 37, 0.9);
        color: white;
        border: none;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        font-size: 24px;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
    `;
    
    const nextBtn = document.createElement('button');
    nextBtn.innerHTML = 'â€º';
    nextBtn.className = 'slider-btn next-btn';
    nextBtn.style.cssText = prevBtn.style.cssText;
    
    // í˜ì´ì§€ ì¸ë””ì¼€ì´í„°
    const indicator = document.createElement('div');
    indicator.className = 'slider-indicator';
    indicator.style.cssText = `
        background: rgba(255, 255, 255, 0.9);
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 14px;
        font-weight: 500;
        color: #333;
        display: flex;
        align-items: center;
        justify-content: center;
        min-width: 80px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    `;
    indicator.textContent = `1 / ${totalSlides}`;
    
    navContainer.appendChild(prevBtn);
    navContainer.appendChild(indicator);
    navContainer.appendChild(nextBtn);
    container.appendChild(navContainer);
    
    // ë²„íŠ¼ ì´ë²¤íŠ¸
    prevBtn.addEventListener('click', function() {
        if (currentSlideIndex > 0) {
            updateSliderPosition(currentSlideIndex - 1);
        }
    });
    
    nextBtn.addEventListener('click', function() {
        if (currentSlideIndex < totalSlides - 1) {
            updateSliderPosition(currentSlideIndex + 1);
        }
    });
    
    // í‚¤ë³´ë“œ ì´ë²¤íŠ¸
    document.addEventListener('keydown', function(e) {
        if (e.key === 'ArrowLeft' && currentSlideIndex > 0) {
            updateSliderPosition(currentSlideIndex - 1);
        } else if (e.key === 'ArrowRight' && currentSlideIndex < totalSlides - 1) {
            updateSliderPosition(currentSlideIndex + 1);
        }
    });
    
    // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateButtonStates() {
        prevBtn.disabled = currentSlideIndex === 0;
        nextBtn.disabled = currentSlideIndex === totalSlides - 1;
        prevBtn.style.opacity = currentSlideIndex === 0 ? '0.5' : '1';
        nextBtn.style.opacity = currentSlideIndex === totalSlides - 1 ? '0.5' : '1';
    }
    
    // ì´ˆê¸° ìƒíƒœ ì„¤ì •
    updateButtonStates();
}

// ìŠ¬ë¼ì´ë” í„°ì¹˜/ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸
function addSliderEvents(sliderContainer, totalSlides) {
    let startX = 0;
    let currentX = 0;
    let isDragging = false;
    
    function handleStart(e) {
        // ì´ë¯¸ì§€ë‚˜ ë¹„ë””ì˜¤ë¥¼ í´ë¦­í•œ ê²½ìš° ë“œë˜ê·¸ ì‹œì‘í•˜ì§€ ì•ŠìŒ
        if (e.target.tagName === 'IMG' || e.target.tagName === 'VIDEO' || e.target.closest('.video-container')) {
            return;
        }
        
        isDragging = true;
        startX = e.type === 'mousedown' ? e.clientX : e.touches[0].clientX;
        sliderContainer.style.transition = 'none';
        console.log('ë“œë˜ê·¸ ì‹œì‘:', { startX, isDragging });
    }
    
    function handleMove(e) {
        if (!isDragging) return;
        
        e.preventDefault();
        currentX = e.type === 'mousemove' ? e.clientX : e.touches[0].clientX;
        const diff = currentX - startX;
        
        // ë“œë˜ê·¸ ê³„ì‚° - ê° ìŠ¬ë¼ì´ë“œê°€ 100% ë„ˆë¹„ë¥¼ ì°¨ì§€í•˜ë¯€ë¡œ
        const containerWidth = sliderContainer.offsetWidth;
        const translateX = -(currentSlideIndex * 100) + (diff / containerWidth * 100);
        
        sliderContainer.style.transform = `translateX(${translateX}%)`;
        
        console.log('ë“œë˜ê·¸ ì¤‘:', { diff, translateX, currentSlideIndex, containerWidth });
    }
    
    function handleEnd() {
        if (!isDragging) return;
        
        isDragging = false;
        if (sliderContainer) {
            sliderContainer.style.transition = 'transform 0.3s ease';
            
            const diff = currentX - startX;
            const threshold = sliderContainer.offsetWidth * 0.15; // ì„ê³„ê°’ì„ ë‚®ì¶¤
            
            console.log('ë“œë˜ê·¸ ì¢…ë£Œ:', { diff, threshold, currentSlideIndex, totalSlides });
            
            if (Math.abs(diff) > threshold) {
                if (diff > 0 && currentSlideIndex > 0) {
                    // ì˜¤ë¥¸ìª½ìœ¼ë¡œ ë“œë˜ê·¸ = ì´ì „ ìŠ¬ë¼ì´ë“œ
                    updateSliderPosition(currentSlideIndex - 1);
                } else if (diff < 0 && currentSlideIndex < totalSlides - 1) {
                    // ì™¼ìª½ìœ¼ë¡œ ë“œë˜ê·¸ = ë‹¤ìŒ ìŠ¬ë¼ì´ë“œ
                    updateSliderPosition(currentSlideIndex + 1);
                } else {
                    // ìŠ¬ë¼ì´ë“œê°€ ë³€ê²½ë˜ì§€ ì•Šì€ ê²½ìš° í˜„ì¬ ìœ„ì¹˜ë¡œ ë³µì›
                    updateSliderPosition(currentSlideIndex);
                }
            } else {
                // ìŠ¬ë¼ì´ë“œê°€ ë³€ê²½ë˜ì§€ ì•Šì€ ê²½ìš° í˜„ì¬ ìœ„ì¹˜ë¡œ ë³µì›
                updateSliderPosition(currentSlideIndex);
            }
        }
    }
    
    // ë§ˆìš°ìŠ¤ ì´ë²¤íŠ¸
    sliderContainer.addEventListener('mousedown', handleStart, { passive: false });
    document.addEventListener('mousemove', handleMove, { passive: false });
    document.addEventListener('mouseup', handleEnd, { passive: false });
    
    // í„°ì¹˜ ì´ë²¤íŠ¸
    sliderContainer.addEventListener('touchstart', handleStart, { passive: false });
    sliderContainer.addEventListener('touchmove', handleMove, { passive: false });
    sliderContainer.addEventListener('touchend', handleEnd, { passive: false });
    
    // ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ (ë§ˆìš°ìŠ¤ íœ )
    sliderContainer.addEventListener('wheel', function(e) {
        e.preventDefault();
        
        if (e.deltaY > 0 && currentSlideIndex < totalSlides - 1) {
            // ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤ = ë‹¤ìŒ ìŠ¬ë¼ì´ë“œ
            updateSliderPosition(currentSlideIndex + 1);
        } else if (e.deltaY < 0 && currentSlideIndex > 0) {
            // ìœ„ë¡œ ìŠ¤í¬ë¡¤ = ì´ì „ ìŠ¬ë¼ì´ë“œ
            updateSliderPosition(currentSlideIndex - 1);
        }
    });
}



// ì´ë¯¸ì§€ í™•ëŒ€ ëª¨ë‹¬
function openImageModal(imageSrc, imageTitle) {
    console.log('ì´ë¯¸ì§€ ëª¨ë‹¬ ì—´ê¸°:', imageSrc);
    
    const modal = document.createElement('div');
    modal.className = 'image-modal';
    modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.85);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 3000;
        opacity: 0;
        transition: opacity 0.3s ease;
        cursor: pointer;
    `;
    
    const img = document.createElement('img');
    img.src = imageSrc;
    img.alt = imageTitle;
    img.style.cssText = `
        max-width: 90%;
        max-height: 90%;
        object-fit: contain;
        border-radius: 8px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        cursor: pointer;
    `;
    
    // ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨ ì‹œ ì²˜ë¦¬
    img.onerror = function() {
        console.log('ëª¨ë‹¬ ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨:', imageSrc);
        modal.innerHTML = `
            <div style="
                color: white;
                text-align: center;
                padding: 20px;
            ">
                <div style="font-size: 48px; margin-bottom: 10px;">ğŸ“·</div>
                <div>ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>
                <div style="font-size: 12px; margin-top: 10px;">${imageSrc.split('/').pop()}</div>
            </div>
        `;
    };
    
    modal.appendChild(img);
    document.body.appendChild(modal);
    
    // ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
    setTimeout(() => {
        modal.style.opacity = '1';
    }, 10);
    
    // í´ë¦­ ì‹œ ë‹«ê¸°
    modal.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        console.log('ëª¨ë‹¬ ë‹«ê¸°');
        modal.style.opacity = '0';
        setTimeout(() => {
            if (document.body.contains(modal)) {
                document.body.removeChild(modal);
            }
        }, 300);
    });
    
    // ESC í‚¤ë¡œ ë‹«ê¸°
    const closeOnEscape = function(e) {
        if (e.key === 'Escape') {
            console.log('ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°');
            modal.style.opacity = '0';
            setTimeout(() => {
                if (document.body.contains(modal)) {
                    document.body.removeChild(modal);
                }
            }, 300);
            document.removeEventListener('keydown', closeOnEscape);
        }
    };
    document.addEventListener('keydown', closeOnEscape);
}

// ì˜ìƒ í™•ëŒ€ ëª¨ë‹¬
function openVideoModal(videoSrc, videoTitle) {
    const modal = document.createElement('div');
    modal.className = 'video-modal';
    modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.85);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 3000;
        opacity: 0;
        transition: opacity 0.3s ease;
    `;
    
    const videoContainer = document.createElement('div');
    videoContainer.style.cssText = `
        max-width: 90%;
        max-height: 90%;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        position: relative;
    `;
    
    const video = document.createElement('video');
    video.src = encodeURI(videoSrc);
    video.controls = true;
    video.autoplay = true;
    video.muted = false;
    video.loop = true;
    video.playsInline = true;
    video.style.cssText = `
        width: 100%;
        height: auto;
        max-height: 90vh;
        display: block;
        background: #000;
        filter: brightness(1.2) contrast(1.1);
    `;
    
    // ë¹„ë””ì˜¤ ë¡œë“œ ì‹¤íŒ¨ ì‹œ ì²˜ë¦¬
    video.onerror = function() {
        console.log('ë¹„ë””ì˜¤ ëª¨ë‹¬ ë¡œë“œ ì‹¤íŒ¨:', videoSrc);
        modal.style.opacity = '0';
        setTimeout(() => {
            document.body.removeChild(modal);
        }, 300);
    };
    
    videoContainer.appendChild(video);
    modal.appendChild(videoContainer);
    document.body.appendChild(modal);
    
    // ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
    setTimeout(() => {
        modal.style.opacity = '1';
    }, 10);
    
    // ë¹„ë””ì˜¤ ìë™ ì¬ìƒ
    video.play().catch(error => {
        console.log('ë¹„ë””ì˜¤ ëª¨ë‹¬ ìë™ ì¬ìƒ ì‹¤íŒ¨:', error);
    });
    
    // í´ë¦­ ì‹œ ë‹«ê¸° (ë¹„ë””ì˜¤ ì˜ì—­ ì œì™¸)
    modal.addEventListener('click', function(e) {
        if (e.target === modal) {
            video.pause();
            modal.style.opacity = '0';
            setTimeout(() => {
                document.body.removeChild(modal);
            }, 300);
        }
    });
    
    // ESC í‚¤ë¡œ ë‹«ê¸°
    const closeOnEscape = function(e) {
        if (e.key === 'Escape') {
            video.pause();
            modal.style.opacity = '0';
            setTimeout(() => {
                document.body.removeChild(modal);
            }, 300);
            document.removeEventListener('keydown', closeOnEscape);
        }
    };
    document.addEventListener('keydown', closeOnEscape);
}

// ìœˆë„ìš° ë¦¬ì‚¬ì´ì¦ˆ ì‹œ ìŠ¬ë¼ì´ë” ì¡°ì •
window.addEventListener('resize', function() {
    const mediaContainer = document.getElementById('mediaContainer');
    const sliderContainer = mediaContainer.querySelector('.slider-container');
    
    if (sliderContainer) {
        const containerHeight = Math.max(500, window.innerHeight - 200);
        mediaContainer.style.height = containerHeight + 'px';
        mediaContainer.style.minHeight = '500px';
        
        // ìŠ¬ë¼ì´ë” ì»¨í…Œì´ë„ˆ ë„ˆë¹„ ì¬ì¡°ì •
        const slideItems = sliderContainer.querySelectorAll('.slide-item');
        sliderContainer.style.width = `${slideItems.length * 100}%`;
        
        // ê° ìŠ¬ë¼ì´ë“œ ì•„ì´í…œ ë„ˆë¹„ ì¬ì¡°ì •
        slideItems.forEach(slide => {
            slide.style.flex = `0 0 ${100 / slideItems.length}%`;
        });
    }
});

// í˜ì´ì§€ ê°€ì‹œì„± ë³€ê²½ ì‹œ ë¹„ë””ì˜¤ ì œì–´
document.addEventListener('visibilitychange', function() {
    const videos = document.querySelectorAll('video');
    
    if (document.hidden) {
        videos.forEach(video => {
            video.pause();
        });
    }
});

// í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ í›„ ì´ˆê¸°í™”
window.addEventListener('load', function() {
    console.log('í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
    
    // ë¡œë”© ìˆ¨ê¸°ê¸° (ìµœì¢… ë³´ì¥)
    const loadingElement = document.getElementById('loading');
    if (loadingElement) {
        loadingElement.style.display = 'none';
    }
});
