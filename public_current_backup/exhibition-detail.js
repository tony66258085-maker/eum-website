// ì „ì‹œ ë°ì´í„° ì •ì˜
const exhibitionData = {
    'sensory-dissolution': {
        title: 'DISSOLUTION OF SENSES: ê°ê°í•´ì²´',
        period: '2025.07.01 - 2025.07.31',
        location: 'ì•„íŠ¸ì½”ë¦¬ì•„ë© ë¯¸ë””ì–´ì›”',
        description: 'ë‹¨ì²´ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        fullDescription: 'ë‹¨ì²´ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        photos: [
            'exhibition-details/sensory-dissolution/sensory_dissolution.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution1.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution2.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution3.png',
            'exhibition-details/sensory-dissolution/sensory_dissolution4.png',
            'exhibition-details/sensory-dissolution/sensory_dissolution5.png',
            'exhibition-details/sensory-dissolution/sensory_dissolution6.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution7.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution8.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution9.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution10.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution11.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution12.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution13.jpeg',
            'exhibition-details/sensory-dissolution/sensory_dissolution14.jpeg',
            'exhibition-details/sensory-dissolution/kakao_photo_001.png',
            'exhibition-details/sensory-dissolution/kakao_photo_002.png',
            'exhibition-details/sensory-dissolution/kakao_photo_56__001.jpeg',
            'exhibition-details/sensory-dissolution/kakao_photo_57__001.jpeg',
            'exhibition-details/sensory-dissolution/kakao_photo_57__002.jpeg',
            'exhibition-details/sensory-dissolution/kakao_photo_57__003.jpeg',
            'exhibition-details/sensory-dissolution/kakao_photo_57__004.jpeg',
            'exhibition-details/sensory-dissolution/kakao_photo_57__005.jpeg',
            'exhibition-details/sensory-dissolution/kakao_photo_57__007.jpeg',
            'exhibition-details/sensory-dissolution/kakao_photo_57__008.jpeg',
            'exhibition-details/sensory-dissolution/kakao_photo_57__009.jpeg',
            'exhibition-details/sensory-dissolution/kakao_photo_57__010.jpeg',
            'exhibition-details/sensory-dissolution/kakao_photo_57__012.jpeg',
            'exhibition-details/sensory-dissolution/kakao_photo_57__013.jpeg',
            'exhibition-details/sensory-dissolution/screenshot_2025-08-24.png'
        ],
        videos: []
    },
    'zip': {
        title: '.zip',
        period: '2025.05.26 - 2025.05.29',
        location: 'ê²½ì¼ëŒ€í•™êµ 12í˜¸ê´€ 1F',
        description: 'í•™ê¸°ë§ ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        fullDescription: 'í•™ê¸°ë§ ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        photos: [
            'exhibition-details/zip/IMG_0710_2.jpg',
            'exhibition-details/zip/original_2025-05-26_124413.358_2.jpg',
            'exhibition-details/zip/original_2025-05-26_183546.631.JPG',
            'exhibition-details/zip/original_2025-05-27_135030.609.JPG',
            'exhibition-details/zip/KakaoTalk_Photo_2025-08-24-15-25-55_002.jpeg',
            'exhibition-details/zip/KakaoTalk_Photo_2025-08-24-15-25-55_003.jpeg',
            'exhibition-details/zip/KakaoTalk_Photo_2025-08-24-15-25-55_004.jpeg',
            'exhibition-details/zip/KakaoTalk_Photo_2025-08-24-15-25-55_005.jpeg',
            'exhibition-details/zip/KakaoTalk_Photo_2025-08-24-15-25-55_006.jpeg',
            'exhibition-details/zip/KakaoTalk_Photo_2025-08-24-15-25-55_007.jpeg',
            'exhibition-details/zip/KakaoTalk_Photo_2025-08-24-15-26-18_002.jpeg',
            'exhibition-details/zip/KakaoTalk_Photo_2025-08-24-15-26-18_003.jpeg',
            'exhibition-details/zip/KakaoTalk_Photo_2025-08-24-15-26-18_004.jpeg',
            'exhibition-details/zip/KakaoTalk_Photo_2025-08-24-15-26-18_006.jpeg',
            'exhibition-details/zip/KakaoTalk_Photo_2025-08-24-15-26-18_013.jpeg',
            'exhibition-details/zip/KakaoTalk_Photo_2025-08-24-15-26-18_015.jpeg',
            'exhibition-details/zip/KakaoTalk_Photo_2025-08-24-15-26-18_016.jpeg',
            'exhibition-details/zip/KakaoTalk_Photo_2025-08-24-15-26-18_018.jpeg',
            'exhibition-details/zip/zipphoto1.jpg',
            'exhibition-details/zip/zipphoto2.jpeg',
            'exhibition-details/zip/zipphoto3.jpeg',
            'exhibition-details/zip/zipphoto4.jpeg',
            'exhibition-details/zip/zipphoto5.jpeg',
            'exhibition-details/zip/zipphoto6.jpeg',
            'exhibition-details/zip/zipphoto7.jpeg',
            'exhibition-details/zip/zipphoto8.jpeg',
            'exhibition-details/zip/zipphoto9.jpeg',
            'exhibition-details/zip/zipphoto10.jpeg',
            'exhibition-details/zip/zipphoto11.jpeg',
            'exhibition-details/zip/zipphoto12.jpeg',
            'exhibition-details/zip/zipphoto13.jpeg',
            'exhibition-details/zip/zipphoto14.jpeg',
            'exhibition-details/zip/zipphoto15.jpeg',
            'exhibition-details/zip/zipphoto16.jpg',
            'exhibition-details/zip/zipphoto17.JPG',
            'exhibition-details/zip/zipphoto18.JPG'
        ],
        videos: []
    },
    'clear-things': {
        title: 'ì„ ëª…í•´ì ¸ì•¼ í•  ê²ƒë“¤',
        period: '2024.12.20 - 2024.12.31',
        location: 'MOV.A(ì„±ë¯¸ì‚°ë¡œ 888-11 5F)',
        description: 'ê¹€ë‹¤ìŠ¬ êµìˆ˜ë‹˜ ì „ì‹œ ì°¸ì—¬ ë° ì‘í’ˆ ì œì‘',
        fullDescription: 'ê¹€ë‹¤ìŠ¬ êµìˆ˜ë‹˜ ì „ì‹œ ì°¸ì—¬ ë° ì‘í’ˆ ì œì‘',
        photos: [
            'exhibition-details/clear-things/clear-things1.jpg',
            'exhibition-details/clear-things/clear-things2.jpg',
            'exhibition-details/clear-things/clear-things3.jpg',
            'exhibition-details/clear-things/clear-things4.jpg',
            'exhibition-details/clear-things/clear-things5.jpg',
            'exhibition-details/clear-things/clear-things6.jpg',
            'exhibition-details/clear-things/clear-things7.jpg',
            'exhibition-details/clear-things/clear-things8.jpg'
        ],
        videos: []
    },
    'sobok': {
        title: 'ì†Œë³µ',
        period: '2024.12.16 - 2024.12.20',
        location: 'ê²½ì¼ëŒ€í•™êµ 12í˜¸ê´€ 1F',
        description: 'í•™ê¸°ë§ ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        fullDescription: 'í•™ê¸°ë§ ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        photos: [
            'exhibition-details/sobok/IMG_5010.jpg',
            'exhibition-details/sobok/original_2024-12-16_201060.jpg',
            'exhibition-details/sobok/sobok_group_photo.jpg',
            'exhibition-details/sobok/sobok_photo1.jpg',
            'exhibition-details/sobok/sobok_photo10_edited.jpg',
            'exhibition-details/sobok/sobok_photo11.jpg',
            'exhibition-details/sobok/sobok_photo12.jpg',
            'exhibition-details/sobok/sobok_photo13.jpg',
            'exhibition-details/sobok/sobok_photo14.jpg',
            'exhibition-details/sobok/sobok_photo3.jpg',
            'exhibition-details/sobok/sobok_photo4.jpg',
            'exhibition-details/sobok/sobok_photo5.jpg',
            'exhibition-details/sobok/sobok_photo6.jpg',
            'exhibition-details/sobok/sobok_photo7.jpg',
            'exhibition-details/sobok/sobok_photo8.jpg',
            'exhibition-details/sobok/sobok_seungje.png',
            'exhibition-details/sobok/sobok_seunghun.png',
            'exhibition-details/sobok/sobok_additional_photo1.jpg',
            'exhibition-details/sobok/sobok_additional_photo2.jpg',
            'exhibition-details/sobok/sobok_additional_photo5.jpg',
            'exhibition-details/sobok/sobok_additional_photo6.jpg',
            'exhibition-details/sobok/sobok_additional_photo7.jpg'
        ],
        videos: []
    },
    'future-fragments': {
        title: 'ë¯¸ë˜ì˜ íŒŒí¸ë“¤',
        period: '2024.10.18 - 2024.11.10',
        location: 'ëŒ€êµ¬ê²½ë¶ë””ìì¸ì„¼í„° 1F Media Wall',
        description: 'êµì™¸ ì „ì‹œ ì‘ê°€ë¡œ ì°¸ì—¬ ë° ì‘í’ˆ ì œì‘',
        fullDescription: 'êµì™¸ ì „ì‹œ ì‘ê°€ë¡œ ì°¸ì—¬ ë° ì‘í’ˆ ì œì‘',
        photos: [
            'exhibition-details/future-fragments/future_fragments_photo1_edited.jpg',
            'exhibition-details/future-fragments/future_fragments_photo2_edited.jpg',
            'exhibition-details/future-fragments/future_fragments_photo3_edited.jpg',
            'exhibition-details/future-fragments/future_fragments_photo5_edited_edited.jpg',
            'exhibition-details/future-fragments/future_fragments_photo6_edited.jpg',
            'exhibition-details/future-fragments/future_fragments_photo7.jpg'
        ],
        videos: []
    },
    'mimyo': {
        title: 'ç¾, ë¬˜í•˜ë‹¤',
        period: '2024.06.04 - 2024.06.10',
        location: 'ê²½ì¼ëŒ€í•™êµ 11í˜¸ê´€ ê°¤ëŸ¬ë¦¬',
        description: 'í•™ê¸°ë§ ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        fullDescription: 'í•™ê¸°ë§ ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        photos: [
            'exhibition-details/mimyo/mimyo_photo1.jpg',
            'exhibition-details/mimyo/mimyo_photo2.jpg',
            'exhibition-details/mimyo/mimyo_photo3.jpg',
            'exhibition-details/mimyo/mimyo_photo4.jpg',
            'exhibition-details/mimyo/mimyo_photo5.jpg',
            'exhibition-details/mimyo/mimyo_photo6.jpg'
        ],
        videos: []
    },
    'meta-festival': {
        title: 'GYEONGBUK META CONTENTS FESTIVAL',
        period: '2024.05.31 - 2024.06.02',
        location: 'ëŒ€êµ¬ EXCO ë™ê´€ 1F HALL 6',
        description: 'ë©”íƒ€ì½˜í…ì¸  í•™ê³¼ ëŒ€í‘œ ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        fullDescription: 'ë©”íƒ€ì½˜í…ì¸  í•™ê³¼ ëŒ€í‘œ ì „ì‹œ ê¸°íš ë° ì‘í’ˆ ì œì‘',
        photos: [
            'exhibition-details/metacontents-festival/ë©”íƒ€ì½˜ êµ¬ë„.png',
            'exhibition-details/metacontents-festival/ë©”íƒ€ì½˜ ì‚¬ì§„1_edited.jpg',
            'exhibition-details/metacontents-festival/ë©”íƒ€ì½˜ ì‚¬ì§„2_edited.jpg',
            'exhibition-details/metacontents-festival/ë©”íƒ€ì½˜ ì‚¬ì§„3_edited.png',
            'exhibition-details/metacontents-festival/ë©”íƒ€ì½˜ ì‚¬ì§„4_edited.jpg',
            'exhibition-details/metacontents-festival/ë©”íƒ€ì½˜ ì‚¬ì§„5_edited_edited.jpg',
            'exhibition-details/metacontents-festival/ë©”íƒ€ì½˜ ì‘ì—…ê³¼ì •_edited.png',
            'exhibition-details/metacontents-festival/ë©”íƒ€ì½˜ ì‘ì—…ê³¼ì •2_edited.jpg'
        ],
        videos: []
    },
    'survival': {
        title: 'SURVIVAL',
        period: '2024.02.17 - 2024.02.25',
        location: 'ëŒ€êµ¬ ì¤‘êµ¬ ë™ë•ë¡œ 30ê¸¸ 117 2F ì•„íŠ¸ìŠ¤í…”ë¼ ì†Œë…¸',
        description: 'ë©”íƒ€ì½˜í…ì¸ ìœµí•©ì „ê³µì˜ ì„±ê³¼ ë³´ê³ íšŒ',
        fullDescription: 'ë©”íƒ€ì½˜í…ì¸ ìœµí•©ì „ê³µì˜ ì„±ê³¼ ë³´ê³ íšŒ',
        photos: [
            'exhibition-details/SURVIVAL/survival_photo1.png',
            'exhibition-details/SURVIVAL/survival_photo2.png',
            'exhibition-details/SURVIVAL/survival_photo3.png',
            'exhibition-details/SURVIVAL/survival_photo4.png',
            'exhibition-details/SURVIVAL/survival_photo5.png',
            'exhibition-details/SURVIVAL/survival_photo6.png'
        ],
        videos: [
            'exhibition-details/SURVIVAL/survival_video2.mp4'
        ]
    }
};

// DOMì´ ë¡œë“œëœ í›„ ì‹¤í–‰
document.addEventListener('DOMContentLoaded', function() {
    // URL íŒŒë¼ë¯¸í„°ì—ì„œ ì „ì‹œ ID ê°€ì ¸ì˜¤ê¸°
    const urlParams = new URLSearchParams(window.location.search);
    const exhibitionId = urlParams.get('id');
    
    if (exhibitionId && exhibitionData[exhibitionId]) {
        loadExhibition(exhibitionId);
    } else {
        // ê¸°ë³¸ê°’ìœ¼ë¡œ ì²« ë²ˆì§¸ ì „ì‹œ ë¡œë“œ
        const firstExhibitionId = Object.keys(exhibitionData)[0];
        loadExhibition(firstExhibitionId);
    }
    
    // ë’¤ë¡œê°€ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸
    const backBtn = document.getElementById('backBtn');
    backBtn.addEventListener('click', function() {
        window.history.back();
    });
    
    // ë‹«ê¸° ë²„íŠ¼ ì´ë²¤íŠ¸
    const closeBtn = document.getElementById('closeBtn');
    closeBtn.addEventListener('click', function() {
        window.history.back();
    });
    
    // ESC í‚¤ë¡œ ë’¤ë¡œê°€ê¸°
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            window.history.back();
        }
    });
});

// ì „ì‹œ ë¡œë“œ í•¨ìˆ˜
function loadExhibition(exhibitionId) {
    const data = exhibitionData[exhibitionId];
    if (!data) return;
    
    // í—¤ë” ì •ë³´ ì„¤ì •
    document.getElementById('exhibitionTitle').textContent = data.title;
    document.getElementById('exhibitionPeriod').textContent = data.period;
    document.getElementById('exhibitionLocation').textContent = data.location;
    
    // ì „ì‹œ ìƒì„¸ ì„¤ëª… ì„¤ì •
    const descriptionElement = document.getElementById('exhibitionDescription');
    if (data.fullDescription) {
        descriptionElement.textContent = data.fullDescription;
        descriptionElement.style.display = 'block';
    } else {
        descriptionElement.style.display = 'none';
    }
    
    // ë¯¸ë””ì–´ ì»¨í…Œì´ë„ˆ ì´ˆê¸°í™”
    const mediaContainer = document.getElementById('mediaContainer');
    mediaContainer.innerHTML = '';
    
    // ëª¨ë“  ë¯¸ë””ì–´ íŒŒì¼ì„ í•˜ë‚˜ì˜ ë°°ì—´ë¡œ í•©ì¹˜ê¸°
    const allMedia = [];
    
    // ì‚¬ì§„ ì¶”ê°€
    data.photos.forEach(photo => {
        allMedia.push({
            type: 'photo',
            src: photo,
            title: data.title
        });
    });
    
    // ì˜ìƒ ì¶”ê°€
    data.videos.forEach(video => {
        allMedia.push({
            type: 'video',
            src: video,
            title: data.title
        });
    });
    
    // ë¯¸ë””ì–´ ìˆœì„œë¥¼ ëœë¤í•˜ê²Œ ì„ê¸°
    shuffleArray(allMedia);
    
    // ë¯¸ë””ì–´ ì•„ì´í…œ ìƒì„± ë° ë°°ì¹˜
    createMediaItems(allMedia, mediaContainer);
    
    // ë¡œë”© ìˆ¨ê¸°ê¸°
    setTimeout(() => {
        document.getElementById('loading').classList.add('hidden');
    }, 1000);
}

// ë°°ì—´ì„ ëœë¤í•˜ê²Œ ì„ëŠ” í•¨ìˆ˜
function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

// ë¯¸ë””ì–´ ì•„ì´í…œ ìƒì„± ë° ë°°ì¹˜ (ë§ˆì¸ë“œë§µ ìŠ¤íƒ€ì¼)
function createMediaItems(mediaArray, container) {
    const containerWidth = container.offsetWidth;
    const containerHeight = Math.max(800, window.innerHeight - 200);
    
    // ì»¨í…Œì´ë„ˆ ë†’ì´ ì„¤ì •
    container.style.height = containerHeight + 'px';
    
    // ì¤‘ì•™ì  ê³„ì‚°
    const centerX = containerWidth / 2;
    const centerY = containerHeight / 2;
    
    // ë§ˆì¸ë“œë§µ ë°°ì¹˜ë¥¼ ìœ„í•œ ì„¤ì •
    const isMobile = window.innerWidth <= 768;
    const baseRadius = isMobile ? 120 : 200; // ê¸°ë³¸ ë°˜ì§€ë¦„
    const maxRadius = isMobile ? 300 : 500; // ìµœëŒ€ ë°˜ì§€ë¦„
    
    // ë¯¸ë””ì–´ ì•„ì´í…œë“¤ì„ ë§ˆì¸ë“œë§µ í˜•íƒœë¡œ ë°°ì¹˜
    mediaArray.forEach((media, index) => {
        const item = createMediaItem(media, index);
        
        // ëœë¤í•œ í¬ê¸° ì„¤ì •
        const size = getRandomSize();
        
        // ë§ˆì¸ë“œë§µ ìœ„ì¹˜ ê³„ì‚° (ì¤‘ì•™ì—ì„œ ë°©ì‚¬í˜•ìœ¼ë¡œ)
        const angle = (index / mediaArray.length) * 2 * Math.PI + (Math.random() - 0.5) * 0.5; // ì•½ê°„ì˜ ëœë¤ì„± ì¶”ê°€
        const radius = baseRadius + Math.random() * (maxRadius - baseRadius);
        
        // ê·¹ì¢Œí‘œë¥¼ ì§êµì¢Œí‘œë¡œ ë³€í™˜
        const x = centerX + Math.cos(angle) * radius - size.width / 2;
        const y = centerY + Math.sin(angle) * radius - size.height / 2;
        
        // í™”ë©´ ê²½ê³„ ë‚´ì— ìœ„ì¹˜í•˜ë„ë¡ ì¡°ì •
        const margin = 20;
        const adjustedX = Math.max(margin, Math.min(containerWidth - size.width - margin, x));
        const adjustedY = Math.max(margin, Math.min(containerHeight - size.height - margin, y));
        
        // ì•„ì´í…œ ìŠ¤íƒ€ì¼ ì„¤ì •
        item.style.width = size.width + 'px';
        item.style.height = size.height + 'px';
        item.style.left = adjustedX + 'px';
        item.style.top = adjustedY + 'px';
        
        // ì• ë‹ˆë©”ì´ì…˜ ì§€ì—° ì„¤ì • (ì¤‘ì•™ì—ì„œ ë°”ê¹¥ìª½ìœ¼ë¡œ)
        const distanceFromCenter = Math.sqrt((adjustedX - centerX) ** 2 + (adjustedY - centerY) ** 2);
        const maxDistance = Math.sqrt((containerWidth / 2) ** 2 + (containerHeight / 2) ** 2);
        const delay = (distanceFromCenter / maxDistance) * 0.5 + (index * 0.05);
        item.style.animationDelay = delay + 's';
        
        container.appendChild(item);
    });
}

// ë¯¸ë””ì–´ ì•„ì´í…œ ìƒì„±
function createMediaItem(media, index) {
    const item = document.createElement('div');
    item.className = `media-item ${media.type}-item`;
    
    if (media.type === 'photo') {
        const img = document.createElement('img');
        // URL ì¸ì½”ë”©ì„ ì ìš©í•˜ì—¬ í•œê¸€ íŒŒì¼ëª… ë¬¸ì œ í•´ê²°
        img.src = encodeURI(media.src);
        img.alt = media.title;
        img.loading = 'lazy';
        
        // ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨ ì‹œ ì²˜ë¦¬
        img.onerror = function() {
            console.log('ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨:', media.src);
            // ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨ ì‹œ ëŒ€ì²´ í…ìŠ¤íŠ¸ í‘œì‹œ
            item.innerHTML = `
                <div style="
                    width: 100%;
                    height: 100%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    background: #f5f5f5;
                    color: #666;
                    font-size: 12px;
                    text-align: center;
                    padding: 10px;
                    border: 1px solid #ddd;
                ">
                    <div>
                        <div style="font-size: 24px; margin-bottom: 5px;">ğŸ“·</div>
                        <div>ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>
                        <div style="font-size: 10px; margin-top: 5px;">${media.src.split('/').pop()}</div>
                    </div>
                </div>
            `;
        };
        
        // ì´ë¯¸ì§€ ë¡œë“œ ì„±ê³µ ì‹œ ë¡œê·¸
        img.onload = function() {
            console.log('ì´ë¯¸ì§€ ë¡œë“œ ì„±ê³µ:', media.src);
        };
        
        item.appendChild(img);
        
        // í´ë¦­ ì‹œ í™•ëŒ€
        item.addEventListener('click', function() {
            openImageModal(media.src, media.title);
        });
        
    } else if (media.type === 'video') {
        const video = document.createElement('video');
        // URL ì¸ì½”ë”©ì„ ì ìš©í•˜ì—¬ í•œê¸€ íŒŒì¼ëª… ë¬¸ì œ í•´ê²°
        video.src = encodeURI(media.src);
        video.muted = true;
        video.loop = true;
        video.playsInline = true;
        video.preload = 'metadata';
        
        // ë¹„ë””ì˜¤ ë¡œë“œ ì‹¤íŒ¨ ì‹œ ì²˜ë¦¬
        video.onerror = function() {
            console.log('ë¹„ë””ì˜¤ ë¡œë“œ ì‹¤íŒ¨:', media.src);
            item.style.display = 'none';
        };
        
        // ë¹„ë””ì˜¤ ë¡œë“œ ì„±ê³µ ì‹œ ì²˜ë¦¬
        video.onloadedmetadata = function() {
            console.log('ë¹„ë””ì˜¤ ë¡œë“œ ì„±ê³µ:', media.src);
        };
        
        item.appendChild(video);
        
        // í´ë¦­ ì‹œ í™•ëŒ€ ëª¨ë‹¬ì—ì„œ ì¬ìƒ
        item.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            openVideoModal(encodeURI(media.src), media.title);
        });
        
        // í˜¸ë²„ ì‹œ ìë™ ì¬ìƒ (ë¯¸ë¦¬ë³´ê¸°)
        item.addEventListener('mouseenter', function() {
            video.play().then(() => {
                item.style.setProperty('--play-icon-opacity', '0');
            }).catch(error => {
                console.log('ë¹„ë””ì˜¤ ìë™ ì¬ìƒ ì‹¤íŒ¨:', error);
            });
        });
        
        item.addEventListener('mouseleave', function() {
            video.pause();
            item.style.setProperty('--play-icon-opacity', '1');
        });
        
        // í„°ì¹˜ ì´ë²¤íŠ¸ (ëª¨ë°”ì¼ìš©) - í™•ëŒ€ ëª¨ë‹¬ì—ì„œ ì¬ìƒ
        item.addEventListener('touchstart', function(e) {
            e.preventDefault();
            openVideoModal(encodeURI(media.src), media.title);
        });
    }
    
    return item;
}

// ëœë¤ í¬ê¸° ìƒì„±
function getRandomSize() {
    const isMobile = window.innerWidth <= 768;
    
    if (isMobile) {
        // ëª¨ë°”ì¼ì—ì„œëŠ” ë” ì‘ì€ í¬ê¸°
        const mobileSizes = [
            { width: 120, height: 90 },
            { width: 140, height: 100 },
            { width: 100, height: 140 },
            { width: 130, height: 110 },
            { width: 110, height: 130 }
        ];
        return mobileSizes[Math.floor(Math.random() * mobileSizes.length)];
    } else {
        // ë°ìŠ¤í¬í†± í¬ê¸°
        const sizes = [
            { width: 200, height: 150 },
            { width: 250, height: 180 },
            { width: 300, height: 200 },
            { width: 180, height: 250 },
            { width: 220, height: 300 },
            { width: 280, height: 220 },
            { width: 320, height: 240 },
            { width: 240, height: 320 }
        ];
        return sizes[Math.floor(Math.random() * sizes.length)];
    }
}



// ì´ë¯¸ì§€ í™•ëŒ€ ëª¨ë‹¬
function openImageModal(imageSrc, imageTitle) {
    const modal = document.createElement('div');
    modal.className = 'image-modal';
    modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.85);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 3000;
        opacity: 0;
        transition: opacity 0.3s ease;
    `;
    
    const img = document.createElement('img');
    img.src = encodeURI(imageSrc);
    img.alt = imageTitle;
    img.style.cssText = `
        max-width: 90%;
        max-height: 90%;
        object-fit: contain;
        border-radius: 8px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    `;
    
    modal.appendChild(img);
    document.body.appendChild(modal);
    
    // ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
    setTimeout(() => {
        modal.style.opacity = '1';
    }, 10);
    
    // í´ë¦­ ì‹œ ë‹«ê¸°
    modal.addEventListener('click', function() {
        modal.style.opacity = '0';
        setTimeout(() => {
            document.body.removeChild(modal);
        }, 300);
    });
    
    // ESC í‚¤ë¡œ ë‹«ê¸°
    const closeOnEscape = function(e) {
        if (e.key === 'Escape') {
            modal.style.opacity = '0';
            setTimeout(() => {
                document.body.removeChild(modal);
            }, 300);
            document.removeEventListener('keydown', closeOnEscape);
        }
    };
    document.addEventListener('keydown', closeOnEscape);
}

// ì˜ìƒ í™•ëŒ€ ëª¨ë‹¬
function openVideoModal(videoSrc, videoTitle) {
    const modal = document.createElement('div');
    modal.className = 'video-modal';
    modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.85);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 3000;
        opacity: 0;
        transition: opacity 0.3s ease;
    `;
    
    const videoContainer = document.createElement('div');
    videoContainer.style.cssText = `
        max-width: 90%;
        max-height: 90%;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        position: relative;
    `;
    
    const video = document.createElement('video');
    video.src = encodeURI(videoSrc);
    video.controls = true;
    video.autoplay = true;
    video.muted = false;
    video.loop = true;
    video.playsInline = true;
    video.style.cssText = `
        width: 100%;
        height: auto;
        max-height: 90vh;
        display: block;
        background: #000;
        filter: brightness(1.2) contrast(1.1);
    `;
    
    // ë¹„ë””ì˜¤ ë¡œë“œ ì‹¤íŒ¨ ì‹œ ì²˜ë¦¬
    video.onerror = function() {
        console.log('ë¹„ë””ì˜¤ ëª¨ë‹¬ ë¡œë“œ ì‹¤íŒ¨:', videoSrc);
        modal.style.opacity = '0';
        setTimeout(() => {
            document.body.removeChild(modal);
        }, 300);
    };
    
    videoContainer.appendChild(video);
    modal.appendChild(videoContainer);
    document.body.appendChild(modal);
    
    // ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘
    setTimeout(() => {
        modal.style.opacity = '1';
    }, 10);
    
    // ë¹„ë””ì˜¤ ìë™ ì¬ìƒ
    video.play().catch(error => {
        console.log('ë¹„ë””ì˜¤ ëª¨ë‹¬ ìë™ ì¬ìƒ ì‹¤íŒ¨:', error);
    });
    
    // í´ë¦­ ì‹œ ë‹«ê¸° (ë¹„ë””ì˜¤ ì˜ì—­ ì œì™¸)
    modal.addEventListener('click', function(e) {
        if (e.target === modal) {
            video.pause();
            modal.style.opacity = '0';
            setTimeout(() => {
                document.body.removeChild(modal);
            }, 300);
        }
    });
    
    // ESC í‚¤ë¡œ ë‹«ê¸°
    const closeOnEscape = function(e) {
        if (e.key === 'Escape') {
            video.pause();
            modal.style.opacity = '0';
            setTimeout(() => {
                document.body.removeChild(modal);
            }, 300);
            document.removeEventListener('keydown', closeOnEscape);
        }
    };
    document.addEventListener('keydown', closeOnEscape);
}

// ìœˆë„ìš° ë¦¬ì‚¬ì´ì¦ˆ ì‹œ ë¯¸ë””ì–´ ì¬ë°°ì¹˜ (ë§ˆì¸ë“œë§µ ìŠ¤íƒ€ì¼)
window.addEventListener('resize', function() {
    const mediaContainer = document.getElementById('mediaContainer');
    const mediaItems = mediaContainer.querySelectorAll('.media-item');
    
    if (mediaItems.length > 0) {
        const containerWidth = mediaContainer.offsetWidth;
        const containerHeight = Math.max(800, window.innerHeight - 200);
        
        mediaContainer.style.height = containerHeight + 'px';
        
        // ì¤‘ì•™ì  ê³„ì‚°
        const centerX = containerWidth / 2;
        const centerY = containerHeight / 2;
        
        // ë§ˆì¸ë“œë§µ ë°°ì¹˜ë¥¼ ìœ„í•œ ì„¤ì •
        const isMobile = window.innerWidth <= 768;
        const baseRadius = isMobile ? 120 : 200;
        const maxRadius = isMobile ? 300 : 500;
        
        mediaItems.forEach((item, index) => {
            // ëœë¤í•œ í¬ê¸° ì„¤ì •
            const size = getRandomSize();
            
            // ë§ˆì¸ë“œë§µ ìœ„ì¹˜ ê³„ì‚° (ì¤‘ì•™ì—ì„œ ë°©ì‚¬í˜•ìœ¼ë¡œ)
            const angle = (index / mediaItems.length) * 2 * Math.PI + (Math.random() - 0.5) * 0.5;
            const radius = baseRadius + Math.random() * (maxRadius - baseRadius);
            
            // ê·¹ì¢Œí‘œë¥¼ ì§êµì¢Œí‘œë¡œ ë³€í™˜
            const x = centerX + Math.cos(angle) * radius - size.width / 2;
            const y = centerY + Math.sin(angle) * radius - size.height / 2;
            
            // í™”ë©´ ê²½ê³„ ë‚´ì— ìœ„ì¹˜í•˜ë„ë¡ ì¡°ì •
            const margin = 20;
            const adjustedX = Math.max(margin, Math.min(containerWidth - size.width - margin, x));
            const adjustedY = Math.max(margin, Math.min(containerHeight - size.height - margin, y));
            
            item.style.width = size.width + 'px';
            item.style.height = size.height + 'px';
            item.style.left = adjustedX + 'px';
            item.style.top = adjustedY + 'px';
        });
    }
});

// í˜ì´ì§€ ê°€ì‹œì„± ë³€ê²½ ì‹œ ë¹„ë””ì˜¤ ì œì–´
document.addEventListener('visibilitychange', function() {
    const videos = document.querySelectorAll('video');
    
    if (document.hidden) {
        videos.forEach(video => {
            video.pause();
        });
    }
});
